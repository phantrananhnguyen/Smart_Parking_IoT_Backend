<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Smart Parking Login</title>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap");

      * {
        box-sizing: border-box;
      }

      body,
      html {
        margin: 0;
        padding: 0;
        height: 100vh;

        background: url("parking-lot.jpg") center/cover no-repeat fixed;
        display: flex;
        justify-content: center;
        align-items: center;
        font-family: "Inter", sans-serif;
      }

      .login-container {
        background: linear-gradient(
          180deg,
          rgba(0, 132, 112, 0.8) 0%,
          rgba(1, 92, 98, 0.8) 100%
        );
        backdrop-filter: blur(15px);
        padding: 30px 60px;
        border-radius: 20px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        width: 100%;
        max-width: 900px;
        height: auto;
        min-height: 400px;
        text-align: center;
        color: white;
        border: 1px solid rgba(255, 255, 255, 0.2);
        display: flex;
        flex-direction: column;
        justify-content: center;
      }

      .logo {
        width: 70px;
        height: 70px;
        background-color: rgba(255, 255, 255, 0.95);
        border-radius: 50%;
        margin: 0 auto 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
      }

      .logo svg {
        width: 42px;
        height: 42px;
        fill: #2d9a87;
      }

      .welcome-text {
        font-size: 1rem;
        font-weight: 400;
        margin-bottom: 8px;
        color: rgba(255, 255, 255, 0.95);
      }

      .title {
        font-size: 1.8rem;
        font-weight: 600;
        margin-bottom: 30px;
        color: white;
      }

      .form-group {
        margin-bottom: 20px;
        text-align: left;
      }

      .input-wrapper {
        position: relative;
      }

      .input-icon {
        position: absolute;
        left: 16px;
        top: 50%;
        transform: translateY(-50%);
        width: 20px;
        height: 20px;
        fill: #666;
        z-index: 2;
      }

      input[type="email"],
      input[type="password"],
      input[type="text"] {
        width: 100%;
        padding: 16px 16px 16px 50px;
        border: none;
        border-radius: 8px;
        font-size: 1rem;
        font-family: inherit;
        background-color: rgba(255, 255, 255, 0.95);
        color: #333;
        outline: none;
        transition: all 0.3s ease;
        backdrop-filter: blur(5px);
      }

      input[type="email"]:focus,
      input[type="password"]:focus,
      input[type="text"]:focus {
        background-color: white;
        box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.3);
      }

      .password-wrapper {
        position: relative;
      }

      .toggle-password {
        position: absolute;
        right: 16px;
        top: 50%;
        transform: translateY(-50%);
        width: 24px;
        height: 24px;
        cursor: pointer;
        stroke: #666;
        background: none;
        border: none;
        padding: 0;
        transition: stroke 0.3s;
      }

      .toggle-password:hover {
        stroke: #2d9a87;
      }

      .login-btn {
        width: 100%;
        background: linear-gradient(135deg, #e91e63 0%, #c2185b 100%);
        color: white;
        border: none;
        padding: 14px;
        border-radius: 8px;
        font-size: 1rem;
        font-weight: 600;
        font-family: inherit;
        cursor: pointer;
        transition: all 0.3s ease;
        text-transform: none;
        margin-top: 10px;
      }

      .login-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(233, 30, 99, 0.4);
      }

      .login-btn:active {
        transform: translateY(0);
      }

      .message {
        padding: 12px;
        margin: 15px 0;
        border-radius: 8px;
        font-size: 0.9rem;
        text-align: center;
        animation: slideIn 0.3s ease-out;
        backdrop-filter: blur(10px);
      }

      .message.error {
        background-color: rgba(244, 67, 54, 0.9);
        color: white;
        border: 1px solid rgba(244, 67, 54, 0.3);
      }

      .message.success {
        background-color: rgba(76, 175, 80, 0.9);
        color: white;
        border: 1px solid rgba(76, 175, 80, 0.3);
      }

      @keyframes slideIn {
        from {
          opacity: 0;
          transform: translateY(-10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @media (max-width: 768px) {
        .login-container {
          margin: 20px;
          padding: 40px 30px;
          max-width: 95%;
          min-height: 350px;
        }

        .title {
          font-size: 1.5rem;
        }
      }
    </style>
  </head>
  <body>
    <div class="login-container">
      <div class="logo">
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M12 0.297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"
          />
        </svg>
      </div>

      <div class="welcome-text">Chào mừng trở lại</div>
      <h1 class="title">Đăng nhập</h1>

      <form id="loginForm">
        <div class="form-group">
          <div class="input-wrapper">
            <svg
              class="input-icon"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
            >
              <path
                d="M20 4H4C2.9 4 2 4.9 2 6v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"
              />
            </svg>
            <input type="text" id="email" placeholder="Username" required />
          </div>
        </div>

        <div class="form-group">
          <div class="input-wrapper password-wrapper">
            <svg
              class="input-icon"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
            >
              <path
                d="M18,8h-1V6c0-2.76-2.24-5-5-5S7,3.24,7,6v2H6c-1.1,0-2,0.9-2,2v10c0,1.1,0.9,2,2,2h12c1.1,0,2-0.9,2-2V10C20,8.9,19.1,8,18,8z M12,17c-1.1,0-2-0.9-2-2s0.9-2,2-2s2,0.9,2,2S13.1,17,12,17z M15.1,8H8.9V6c0-1.71,1.39-3.1,3.1-3.1s3.1,1.39,3.1,3.1V8z"
              />
            </svg>
            <input
              type="password"
              id="password"
              placeholder="Mật khẩu"
              required
            />

            <button type="button" class="toggle-password" id="togglePassword">
              <svg
                id="eyeOpen"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
                stroke-width="1.5"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"
                />
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"
                />
              </svg>
              <svg
                id="eyeClosed"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                style="display: none"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88"
                />
              </svg>
            </button>
          </div>
        </div>

        <button type="submit" class="login-btn">Đăng nhập</button>
      </form>
    </div>

    <script>
      const togglePassword = document.getElementById("togglePassword");
      const passwordInput = document.getElementById("password");
      const eyeOpen = document.getElementById("eyeOpen");
      const eyeClosed = document.getElementById("eyeClosed");

      togglePassword.addEventListener("click", function (e) {
        e.preventDefault();
        e.stopPropagation();

        const isPassword = passwordInput.type === "password";
        const currentValue = passwordInput.value;
        const currentFocus = document.activeElement === passwordInput;
        let cursorPos = 0;

        if (currentFocus) {
          cursorPos = passwordInput.selectionStart;
        }

        passwordInput.type = isPassword ? "text" : "password";
        passwordInput.value = currentValue;

        if (currentFocus) {
          passwordInput.focus();
          setTimeout(() => {
            passwordInput.setSelectionRange(cursorPos, cursorPos);
          }, 0);
        }

        eyeOpen.style.display = isPassword ? "none" : "block";
        eyeClosed.style.display = isPassword ? "block" : "none";
      });

      function showMessage(message, type = "success") {
        const existingMessage = document.querySelector(".message");
        if (existingMessage) existingMessage.remove();

        const messageDiv = document.createElement("div");
        messageDiv.className = `message ${type}`;
        messageDiv.textContent = message;

        const form = document.getElementById("loginForm");
        form.appendChild(messageDiv);

        setTimeout(() => {
          if (messageDiv && messageDiv.parentNode) {
            messageDiv.remove();
          }
        }, 2000);
      }

      const loginForm = document.getElementById("loginForm");
      const emailInput = document.getElementById("email");

      loginForm.addEventListener("submit", async function (e) {
        e.preventDefault();

        const name = emailInput.value.trim();
        const password = passwordInput.value.trim();

        if (!name || !password) {
          showMessage(
            "Vui lòng nhập đầy đủ tên đăng nhập và mật khẩu!",
            "error"
          );
          return;
        }

        try {
          const response = await fetch(
            "http://localhost:3000/api/admin/SignIn",
            {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify({ name, password }),
            }
          );

          const data = await response.json();

          if (response.ok) {
            showMessage("Đăng nhập thành công!", "success");
            setTimeout(() => {
              window.location.href = "/Home.html"; // bạn có thể thay đổi thành dashboard hoặc route phù hợp
            }, 1500);
          } else {
            showMessage(data.message || "Đăng nhập thất bại!", "error");
          }
        } catch (err) {
          console.error("Lỗi:", err);
          showMessage("Lỗi máy chủ. Vui lòng thử lại sau!", "error");
        }
      });
    </script>
  </body>
</html>
